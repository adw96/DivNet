# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' remove_base_otu
#'
#' Returns a new VectorXd with the `base_otu` removed.
#'
#' @author Ryan Moore
#'
#' @param base_otu The index of the otu to remove from the input vector
#' @param Wi A single row/sample of the count matrix
#'
#' @return A count vector minus the `base_otu`
NULL

#' mc_loop
#'
#' Runs the MC step for a single sample.
#'
#' @author Ryan Moore
#'
#' @param sidx Index of the current sample
#' @param mc_iters Total number of mc iters to run
#' @param stepsize Variance used for MH samples
#' @param Yi A single row/sample of the logratio matrix
#' @param Wi A single row/sample of the count matrix (same row/sample as for Yi)
#' @param Wi_no_base The same row/sample of the count matrix as Wi, but with the base OTU removed
#' @param eYi A single row/sample of the expected value of the logratio matrix
#' @param sigma_inverse Current estimate of sigma inverse
#' @param Yi_MH An mc_iters x Wi.size() (no. otus) matrix to hold the MC iteration results.  This param will be modified in place.
#' @param per_iter_lrs A vector that stores an (no. otus - 1 ie Yi.size()) x no. samples matrix for each MC iteration.  This param will be modified in place.
NULL

#' run_mc
#'
#' Simulate MC step.
#'
#' @author Ryan Moore
#'
#' @param logratios The logratio matrix.  Dim: nsamples x (notus - 1).
#' @param counts The corresponding count matrix.  Dim: nsamples x notus.
#' @param expected_logratios The current expected value of the logratio matrix.  Dim: nsamples x (notus - 1).
#' @param sigma_inverse The current estimate of sigma inverse.
#' @param base_otu The index of the otu to remove from the input vector
#' @param mc_iters Total number of mc iters to run
#' @param iters_to_burn The number of MC iters to burn
#' @param stepsize Variance used for MH samples
run_mc <- function(logratios, counts, expected_logratios, sigma_inverse, base_otu, mc_iters, iters_to_burn, stepsize) {
    .Call('_DivNet_run_mc', PACKAGE = 'DivNet', logratios, counts, expected_logratios, sigma_inverse, base_otu, mc_iters, iters_to_burn, stepsize)
}

