# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' get_Y_new_and_sigSum
#'
#' Calculate Y_new and sigSum for the current EM iteration.
#'
#' This function avoids having to keep a 3D array in memory and do
#' matrix math along weird strides by updating sigSum after each
#' non-burnt MC iteration, and by keeping a running total of estimated
#' Y values after each non-burnt MC iteration for each sample
#' (converted to a mean at the end of MC iterations).  This also gives
#' the benefit of saving a lot of memory vs. the straight R versions
#' which needed to apply and reduce across a couple different
#' dimensions.  In theory, this should also allow more optimal storage
#' for faster calculations and less memory churn, with the downside
#' being a more complicated function.
#'
#' @author Ryan Moore
#'
#' @param num_samples Number of samples (nrow(Y))
#' @param Y Logratio matrix
#' @param W Corresponding count matrix
#' @param eY Current expected value of logratio matrix
#' @param base OTU index used for base (1-based index)
#' @param sigInv Output of *_network(sigma)
#' @param mciters Number of MC iterations
#' @param iters_to_burn How many MC iters to burn?
#' @param stepsize Variance used for MH samples.
#'   Tweak to adjust acceptance ratio.
#'
#' @return Returns a List containing Y_new and sigSum.
get_Y_new_and_sigSum <- function(num_samples, Y, W, eY, base, sigInv, mciters, iters_to_burn, stepsize) {
    .Call('_DivNet_get_Y_new_and_sigSum', PACKAGE = 'DivNet', num_samples, Y, W, eY, base, sigInv, mciters, iters_to_burn, stepsize)
}

